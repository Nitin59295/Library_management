{% extends 'base.html' %}
{% block content %}
<h2>Login</h2>
<form id="loginForm">
  <input type="text" placeholder="Username" name="username" required><br><br>
  <input type="password" placeholder="Password" name="password" required><br><br>
  <button type="submit">Login</button>
</form>
<div id="result"></div>

<script>
document.getElementById("loginForm").addEventListener("submit", async function(e) {
  e.preventDefault();
  const data = {
    username: this.username.value,
    password: this.password.value
  };
  const res = await fetch("/api/token/", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  });
  const json = await res.json();
  localStorage.setItem("access", json.access);
  document.getElementById("result").innerText = "Logged in! Token saved.";
});
</script>
{% endblock %}
